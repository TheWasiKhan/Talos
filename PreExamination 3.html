{% extends 'base.html' %}
{% block title %}Pre-Examination{% endblock %}
{% block body %}
{% load static %}
{% load i18n %}

<style>
    .navbar a {
        color: white;
    }

    .navbar-nav a {
        color: white;
    }

    .btn-gr {
        background: linear-gradient(45deg, #003a70, #ec0909);
    }

    .btn-gr:hover {
        background: linear-gradient(45deg, #003a70, #6ecbc9);
    }

    .btn-grr {
        background: linear-gradient(45deg, #6ecbc9, #003a70);
    }

    .btn-grr:hover {
        background: linear-gradient(45deg, #ec0909, #003a70);
    }

    .btn-theme {
        background-color: #003a70;
        color: white;
    }

    .btn-theme:hover {
        background-color: #003789 !important;
        color: white !important;
    }

    .btn-outline-theme {
        background-color: transparent;
        border: 1px solid #003a70;
        color: #003a70;
    }

    .btn-outline-theme:hover {
        background-color: transparent;
        color: #003789;
        border: 1px solid #003789;
    }

    .border-theme {
        border-color: #003a70 !important;
    }

    .border-theme:hover {
        border-color: #003789 !important;
    }

    .label-theme {
        color: #ec0909;
    }

    .theme {
        background-color: #003a70;
    }

    .text-theme {
        color: #003a70 !important;
    }

    .theme-light {
        background-color: #f2f3ff;
    }


    ::-webkit-scrollbar-track {
        -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.1);
        background-color: white;
        border-radius: 10px;
    }

    ::-webkit-scrollbar {
        width: 10px;
        height: 10px;
        border-radius: 10px;
        background-color: #F5F5F5;
    }

    ::-webkit-scrollbar-thumb {
        border-radius: 10px;
        background-color: #FFF;
        background-image: -webkit-linear-gradient(top,
                #003a70 0%,
                #6ecbc9 50%,
                #6ecbc9 51%,
                #003a70 100%);
    }

    .nav-tabs .nav-item .nav-link.active {
        background: linear-gradient(to bottom, white 95%, white 5%);
        color: #6ecbc9;
        border-top: solid red 1px;
        border-left: solid red 1px;
        border-right: solid red 1px;
        border-bottom: solid white 2px;

    }

    .nav-tabs .nav-item .nav-link {
        background: linear-gradient(to bottom, #6ecbc9 95%, #F9F9F9 5%);
        border-bottom: solid #F9F9F9 1px;
        color: white;
    }

    .nav-tabs {
        border-bottom: solid red 1px;
        ;
    }

    .nav-tabs .nav-item .nav-link {
        background: linear-gradient(to bottom, #6ecbc9 95%, #F9F9F9 5%);
        border-bottom: solid #F9F9F9 1px;
        color: white;
    }
</style>


<div class="container-fluid mt-2">
        <div class="row g-2 my-1 align-items-stretch ">

            <div class="col-lg-2 ">

                <div class="card shadow border border-danger rounded rounded-2 " id="cl2">
                    <div class="card-body">
                        <div class="d-flex flex-column align-items-center text-center">
                            <img src="https://bootdey.com/img/Content/avatar/avatar7.png" alt="Admin"
                                class="rounded-circle" width="70" />
                            <div class="mt-3">
                                <h4 class="  ">Front Desk</h4>
                                <label class="     mb-1 ">Neha Sharma</label>


                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-10">
                <div class="card shadow" id="cl10">
                    <div class="card-header bg-white  py-1">
                        <div class="row  ">
                            <div class="col">
                                <label class="fw-normal textbluecolor fs-5 fw-semibold "><i
                                        class="fa-solid fa-hospital-user"></i> Pre-Examination</label>
                            </div>
                        </div>
                    </div>
                    <div class="card-body table-responsive  border border-danger rounded rounded-top-0 ">
                        <div id="Paitent_informaton">
                            <div class="row mb-2 ">
                                <div class="col-lg-1 col-md-2 d-lg-flex d-md-flex align-items-center d-none">

                                    <div class="flex-shrink-0">
                                        <img src="/media/{{ appointment_detail.patient_image }}"
                                            alt="Patient" class="rounded-circle" width="90px" />
                                    </div>
                                </div>
                                <div class="col ms-4">
                                    <div class="row mt-1 ">
                                        <div class="col mb-2">
                                            <label class="fw-normal  textbluecolor ">
                                                Patient
                                                Name</label>
                                            <input readonly type="text" class="form-control form-control-sm" value="{{ appointment_detail.patient_name }}">
                                        </div>
                                        <div class="col mb-2">
                                            <label class="fw-normal textbluecolor">
                                                Contact
                                                Number</label>

                                            <input readonly type="text" class="form-control form-control-sm     "
                                                value="{{ appointment_detail.contact_number }}">
                                        </div>
                                        <div class="col mb-2">
                                            <label class="fw-normal  textbluecolor ">
                                                Patient
                                                id</label>
                                            <input readonly type="text" class="form-control form-control-sm " value="{{ appointment_detail.patient_id }}">

                                        </div>
                                        <div class="col mb-2">
                                            <label class="fw-normal  textbluecolor ">
                                                Gender</label>
                                            <input readonly type="text" class="form-control form-control-sm    " value="{{appointment_detail.gender}}">

                                        </div>
                                        <div class="col  mb-2">
                                            <label class="fw-normal    textbluecolor ">Age</label>
                                            <input readonly type="text" name class="form-control form-control-sm   " value="{{ appointment_detail.age }}">
                                        </div>
                                    </div>
                                    <div class="row mt-1 ">
                                        <div class="col mb-2 ">
                                            <label class="fw-normal textbluecolor">
                                                Appointment
                                                id</label>
                                            <input readonly type="text" class="form-control form-control-sm    " value="{{ appointment_detail.appointment_id }}">
                                        </div>
                                        
                                        <div class="col mb-2 ">
                                            <label class="fw-normal textbluecolor">
                                                Date
                                            </label>
                                            <input readonly type="text" class="form-control form-control-sm    " value="{{ appointment_detail.appointment_date }}">
                                        </div>
                                        <div class="col mb-2 ">
                                            <label class="fw-normal textbluecolor">
                                                Appointment
                                                type</label>
                                            <input readonly type="text" class="form-control form-control-sm    " value="{{appointment_detail.appointment_type}}">
                                        </div>

                                        <div class="col mb-2 ">
                                            <label class="fw-normal textbluecolor">
                                                Booking
                                                type</label>
                                            <input readonly type="text" class="form-control form-control-sm    " value="{{appointment_detail.booking_type}}">
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row g-2 my-1 align-items-stretch ">
            <div class="col-lg-12  col-md-12">

                <div class="card-body shadow" style="background-color: #F9F9F9;">
                    <ul class="nav nav-tabs">
                        <li class="nav-item text-center">
                            <a class="nav-link active  fw-bold navlink" data-bs-toggle="tab" href="#Vitals">
                                <span class=" ">
                                    <img src="{% static 'Talos/img/1.png' %}" width="24px" alt="" srcset="">
                                </span> Vitals </a>
                        </li>
                        <li class="nav-item ps-1 text-center">
                            <a class="nav-link   fw-bold navlink" data-bs-toggle="tab" href="#Symptoms"> <span
                                    class=" "><img src="{% static 'Talos/img/2.png' %}" width="24px" alt="" srcset="">
                                </span> Symptoms</a>
                        </li>
                        <li class="nav-item ps-1 text-center">
                            <a class="nav-link   fw-bold navlink" data-bs-toggle="tab" href="#Pre-Existing"> <span
                                    class=" "><img src="{% static 'Talos/img/3.png' %}" width="24px" alt="" srcset="">
                                </span>Pre-Existing</a>
                        </li>
                        <li class="nav-item ps-1 text-center">
                            <a class="nav-link  fw-bold navlink" data-bs-toggle="tab" href="#Upload_Document"><span
                                    class=""><img src="{% static 'Talos/img/4.png' %}" width="24px" alt="" srcset="">
                                </span> Upload Document</a>
                        </li>
                        <div class="ms-auto">
                            <a href="{% url 'medicalHistory' appointment_detail.appointment_id %}"
                                class=" btn btn-theme btn-sm text-white mt-2 me-2 fw-bold ">
                                Medical History
                            </a>
                        </div>
                    </ul>

                    <div
                        class="tab-content border border-danger border-top-0 p-1 rounded rounded-top-0 rounded-bottom-3 bg-white">
                        
                        <div id="Vitals" class="tab-pane  active  mt-3">
                            <div class="card">
                                <div class="card-body ">
                                    <form id="Vitals_Form" method="post" action="{% url 'vitals_insert' %}">
                                        {% csrf_token %}
                                        <input type="hidden" name="appointment_id" value="{{ appointment_detail.appointment_id }}">
                                        {% if vitals %}
                                        <input type="hidden" name="vitals_id" value="{{ vitals.vitals_id }}">
                                        
                                        <div class="row   justify-content-between ">
                                            <div class="col-lg-2 col-md-4 col-sm-6 ">
                                                <label class="fw-normal "><i class="fa-solid fa-arrow-up-long"></i> Height
                                                </label>
                                                <input type="text" value="{{vitals.height}}" name="height" class="form-control form-control-sm" placeholder="In centimeter">
                                            </div>
                                            <div class="col-lg-2 col-md-4 col-sm-12 ">
                                                <label class="fw-normal "><i class="fa-solid fa-scale-balanced"></i>
                                                    Weight</label>
                                                <input type="text" name="weight" value="{{vitals.weight}}" class="form-control form-control-sm" placeholder="In Kg">
                                            </div>

                                            <div class="col-lg-2 col-sm-6">
                                                <label class="fw-normal "><i class="fa-solid fa-droplet"
                                                        style="color: #ec0909;"></i> Blood
                                                    Pressure</label>
                                                <div class="d-flex">
                                                    <input type="text" name="systolic" value="{{vitals.systolic}}" class="form-control form-control-sm"
                                                        placeholder="Systolic" style="flex: 1; margin-right: 5px;">
                                                    <input type="text" name="diastolic" value="{{vitals.diastolic}}" class="form-control form-control-sm"
                                                        placeholder="Diastolic" style="flex: 1;">
                                                </div>

                                            </div>
                                            <div class="col-lg-2 col-sm-6">
                                                <label class="fw-normal "><i
                                                        class="fa-solid fa-temperature-three-quarters textbluecolor"></i>
                                                    Temperature</label>
                                                <input type="text" name="temperature" value="{{vitals.temperature}}" class="form-control form-control-sm" placeholder="In fahrenheit">
                                            </div>
                                            <div class="col-lg-2 col-sm-6">
                                                <label class="fw-normal "><i class="fa-solid fa-heart-pulse"
                                                        style="color: #ec0909;"></i></i>
                                                    Pulse</label>
                                                <input type="text" name="pulse" value="{{vitals.pulse}}" class="form-control form-control-sm" placeholder="Per minute">
                                            </div>
                                        </div>
                                        <div class="row  pt-4 justify-content-between  ">


                                            <div class="col-lg-2 col-sm-6">
                                                <label class="fw-normal "><i class="fa-solid fa-lungs"></i> Respiratory
                                                </label>
                                                <input type="text" name="respiratory_rate" value="{{vitals.respiratory_rate}}" class="form-control form-control-sm"
                                                    placeholder="In breath per minute">
                                            </div>
                                            <div class="col-lg-2 col-md-4 col-sm-6">
                                                <label class="fw-normal ">Random Blood Sugar</label>
                                                <input type="text"  name="random_blood_sugar" value="{{vitals.random_blood_sugar}}" class="form-control form-control-sm" placeholder="In mg/dl">
                                            </div>
                                            <div class="col-lg-2 col-md-4 col-sm-6">
                                                <label class="fw-normal "> Spo2</label>
                                                <input type="text"  name="spo2" value="{{vitals.spo2}}" class="form-control form-control-sm" placeholder="In SvO2">
                                            </div>
                                            <div class="col-lg-2 col-md-4 col-sm-6">
                                                <label class="fw-normal "> Level of Consciousness </label>
                                                <input type="text" name="level_of_consciousness" value="{{vitals.level_of_consciousness}}" class="form-control form-control-sm" placeholder="in GCS">
                                            </div>
                                            <div class="col-lg-2 col-md-4 col-sm-6">
                                                <label class="fw-normal "> Pupillary Response</label>
                                                <input type="text" name="pupillary_response" value="{{vitals.pupillary_response}}" class="form-control form-control-sm" placeholder="in qPLR(%)">
                                            </div>

                                        </div>
                                        {%else%}
                                        <div class="row   justify-content-between ">
                                            <div class="col-lg-2 col-md-4 col-sm-6 ">
                                                <label class="fw-normal "><i class="fa-solid fa-arrow-up-long"></i> Height
                                                </label>
                                                <input type="text"  name="height" class="form-control form-control-sm" placeholder="In centimeter">
                                            </div>
                                            <div class="col-lg-2 col-md-4 col-sm-12 ">
                                                <label class="fw-normal "><i class="fa-solid fa-scale-balanced"></i>
                                                    Weight</label>
                                                <input type="text" name="weight"  class="form-control form-control-sm" placeholder="In Kg">
                                            </div>

                                            <div class="col-lg-2 col-sm-6">
                                                <label class="fw-normal "><i class="fa-solid fa-droplet"
                                                        style="color: #ec0909;"></i> Blood
                                                    Pressure</label>
                                                <div class="d-flex">
                                                    <input type="text" name="systolic"  class="form-control form-control-sm"
                                                        placeholder="Systolic" style="flex: 1; margin-right: 5px;">
                                                    <input type="text" name="diastolic"  class="form-control form-control-sm"
                                                        placeholder="Diastolic" style="flex: 1;">
                                                </div>

                                            </div>
                                            <div class="col-lg-2 col-sm-6">
                                                <label class="fw-normal "><i
                                                        class="fa-solid fa-temperature-three-quarters textbluecolor"></i>
                                                    Temperature</label>
                                                <input type="text" name="temperature"  class="form-control form-control-sm" placeholder="In fahrenheit">
                                            </div>
                                            <div class="col-lg-2 col-sm-6">
                                                <label class="fw-normal "><i class="fa-solid fa-heart-pulse"
                                                        style="color: #ec0909;"></i></i>
                                                    Pulse</label>
                                                <input type="text" name="pulse"  class="form-control form-control-sm" placeholder="Per minute">
                                            </div>
                                        </div>
                                        <div class="row  pt-4 justify-content-between  ">


                                            <div class="col-lg-2 col-sm-6">
                                                <label class="fw-normal "><i class="fa-solid fa-lungs"></i> Respiratory
                                                </label>
                                                <input type="text" name="respiratory_rate"  class="form-control form-control-sm"
                                                    placeholder="In breath per minute">
                                            </div>
                                            <div class="col-lg-2 col-md-4 col-sm-6">
                                                <label class="fw-normal ">Random Blood Sugar</label>
                                                <input type="text"  name="random_blood_sugar"  class="form-control form-control-sm" placeholder="In mg/dl">
                                            </div>
                                            <div class="col-lg-2 col-md-4 col-sm-6">
                                                <label class="fw-normal "> Spo2</label>
                                                <input type="text"  name="spo2"  class="form-control form-control-sm" placeholder="In SvO2">
                                            </div>
                                            <div class="col-lg-2 col-md-4 col-sm-6">
                                                <label class="fw-normal "> Level of Consciousness </label>
                                                <input type="text" name="level_of_consciousness"  class="form-control form-control-sm" placeholder="in GCS">
                                            </div>
                                            <div class="col-lg-2 col-md-4 col-sm-6">
                                                <label class="fw-normal "> Pupillary Response</label>
                                                <input type="text" name="pupillary_response"  class="form-control form-control-sm" placeholder="in qPLR(%)">
                                            </div>

                                        </div>
                                        {% endif %}
                                        <div class="row justify-content-between">
                                            <div class="col">
                                                <button id="submitVitals_Form" type="button" class="btn btn-primary fw-bold float-end mt-2 theme"
                                                    >Next <i
                                                        class="fas fa-chevron-right text-white"></i></button>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>

                        <div id="Symptoms" class="tab-pane  mt-3 p-1 rounded">
                            <h5 class="fw-normal ">Symptoms</h5>
                            <form id="symptomsForm" method="post" action="{% url 'symptoms_insert' %}">
                                {% csrf_token %}
                                <input type="hidden" name="appointment_id" value="{{ appointment_detail.appointment_id }}">
                                {% if symptoms %}
                                <input type="hidden" name="symptoms_id" value="{{ symptoms.symptoms_id }}">
                                {% endif %}
    
                                <textarea name="symptoms" id="" class=" form-control form-control-sm" rows="5"
                                    placeholder="Type Something">{{ symptoms.symptoms }}</textarea>
                                <div class="row justify-content-between">
                                    <div class="col ">
                                        <button type="button" class="btn btn-outline fw-bold  mt-2"
                                            onclick="Backtoprevioustab()" style="background-color: #ced4da;"><i
                                                class="fas fa-chevron-left text-dark"></i> Back

                                        </button>
                                        <button id="submitSymptomsBtn" type="button" class="btn btn-primary fw-bold float-end mt-2 theme"
                                            >Next <i
                                                class="fas fa-chevron-right text-white"></i></button>
                                    </div>
                                </div>
                            </form>
                        </div>
                        
                        <div id="Pre-Existing" class="tab-pane  mt-3 p-1 rounded">
                            <h5 class="fw-normal ">Pre-Existing</h5>
                            <form id="Pre-Existing_Form" method="post" action="{% url 'preexisting_modal_insert' %}">
                                {% csrf_token %}
                                <input type="hidden" name="appointment_id" value="{{ appointment_detail.appointment_id }}">
                                {% if preexistings %}
                                <input type="hidden" name="preexisting_id" value="{{ preexistings.preexisting_id }}">
                                {% endif %}
                                <textarea name="preexisting_info" id="preexisting_info" class=" form-control form-control-sm" rows="5"
                                    placeholder="Type Something">{{preexistings.preexisting_info}}</textarea>
                                <div class="row justify-content-between">
                                    <div class="col ">
                                        <button type="button" class="btn btn-outline fw-bold  mt-2"
                                            onclick="Backtoprevioustab()" style="background-color: #ced4da;"><i
                                                class="fas fa-chevron-left text-dark"></i> Back
                                        </button>
                                        <button id="submitPreExisting_Form" type="button" class="btn btn-primary fw-bold float-end mt-2 theme"
                                            >Next <i
                                                class="fas fa-chevron-right text-white"></i></button>
                                    </div>
                                </div>
                            </form>
                        </div>

                        <div id="Upload_Document" class="tab-pane mt-3 p-1 rounded">
                            <form id="Upload_Document_Form" method="post" enctype="multipart/form-data" action="{% url 'upload_documents' %}">
                                {% csrf_token %}
                                <input type="hidden" name="appointment_id" value="{{ appointment_detail.appointment_id }}">
    
                                <div class="row">
                                    <div class="col table-responsive">
                                        <table id="Docupload" class="table table-bordered">
                                            <thead>
                                                <tr>
                                                    <th>SNo.</th>
                                                    <th>Document name</th>
                                                    <th>Document type</th>
                                                    <th>Description</th>
                                                    <th>Remark</th>
                                                    <th>File</th>
                                                    <th></th>
                                                    <th></th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {% if documents %}
                                                {% for document in documents %}
                                                <tr>
                                                    <input type="hidden" name="document_id" value="{{ document.document_id }}">

                                                    <td>1</td>
                                                    <td>
                                                        <input type="text" name="Upload_Document_name" value="{{ document.document_name}}" class="form-control form-control-sm"
                                                            id="">
                                                    </td>
                                                    <td>
                                                        <select name="Upload_Doc_Type" class="form-control form-control-sm" id="Upload_Doc_Type">
                                                            <option value="Prescription" {% if document.document_type == "Prescription" %}selected{% endif %}>Prescription</option>
                                                            <option value="Lab report" {% if document.document_type == "Lab report" %}selected{% endif %}>Lab report</option>
                                                            <option value="Insurance" {% if document.document_type == "Insurance" %}selected{% endif %}>Insurance</option>
                                                            <option value="X-ray" {% if document.document_type == "X-ray" %}selected{% endif %}>X-ray</option>
                                                    </select>
                                                    </td>
                                                    <td>
                                                        <input type="text" name="Upload_Description" value="{{ document.description }}" class="form-control form-control-sm"
                                                            id="">
                                                    </td>
                                                    <td>
                                                        <input type="text" name="Upload_Remark" value="{{ document.remark }}" class="form-control form-control-sm" id="">
                                                    </td>
                                                    <td>
                                                        <input type="file" name="Upload_File" value="{{ document.document_file }}" class="form-control form-control-sm" id="">
                                                    </td>
                                                    <td>

                                                        <button type="button" class="btn btn-sm add-row backgroundneela "><i
                                                                class="fa-solid fa-plus fa-lg"></i></button>
                                                    </td>
                                                    <td>
                                                        <button type="button" class="btn btn-sm btn-danger remove-rows"
                                                            disabled><i class="fa-regular fa-trash-can fa-lg"></i></button>

                                                    </td>

                                                </tr>
                                                {% endfor %}
                                                {% else %}
                                                <tr>
                                                    <input type="hidden" name="document_id" value="{{ document.document_id }}">

                                                    <td>1</td>
                                                    <td>
                                                        <input type="text" name="Upload_Document_name" value="{{ document.document_name}}" class="form-control form-control-sm"
                                                            id="">
                                                    </td>
                                                    <td>
                                                        <select name="Upload_Doc_Type" class="form-control form-control-sm" id="Upload_Doc_Type">
                                                            <option value="Prescription" >Prescription</option>
                                                            <option value="Lab report" >Lab report</option>
                                                            <option value="Insurance" >Insurance</option>
                                                            <option value="X-ray" >X-ray</option>
                                                    </select>
                                                    </td>
                                                    <td>
                                                        <input type="text" name="Upload_Description" value="" class="form-control form-control-sm"
                                                            id="">
                                                    </td>
                                                    <td>
                                                        <input type="text" name="Upload_Remark" value="" class="form-control form-control-sm" id="">
                                                    </td>
                                                    <td>
                                                        <input type="file" name="Upload_File" value="" class="form-control form-control-sm" id="">
                                                    </td>
                                                    <td>

                                                        <button type="button" class="btn btn-sm add-row backgroundneela "><i
                                                                class="fa-solid fa-plus fa-lg"></i></button>
                                                    </td>
                                                    <td>
                                                        <button type="button" class="btn btn-sm btn-danger remove-rows"
                                                            disabled><i class="fa-regular fa-trash-can fa-lg"></i></button>

                                                    </td>

                                                </tr>
                                                {%endif%}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                <div class="row justify-content-between">
                                    <div class="col ">
                                        <button type="button" class="btn btn-outline fw-bold  mt-2"
                                            onclick="Backtoprevioustab()" style="background-color: #ced4da;"><i
                                                class="fas fa-chevron-left text-dark"></i> Back

                                        </button>
                                        <button id="submitUpload_Document_Form" type="button" class="btn btn-primary fw-bold float-end mt-2 theme"
                                            >Save <i class="bi bi-check-lg "></i></button>
                                    </div>
                                </div>
                            </form>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    

</div>

<!-- Success modal  -->
<div class="modal fade" id="successModal" tabindex="-1" aria-labelledby="successModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="successModalLabel">Success!</h5>
        </div>
        <div class="modal-body">
          Your upload was successful!
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
</div>

<!-- Fail modal  -->
  <div class="modal fade" id="failModal" tabindex="-1" aria-labelledby="failModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="failModalLabel">Success!</h5>
        </div>
        <div class="modal-body">
          !
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
<script>
    function Backtoprevioustab() {
        let curtab = $('.tab-content .active').attr('id');
        let backtab;

        switch (curtab) {
            case 'Symptoms':
                backtab = 'Vitals';
                break;
            case 'Pre-Existing':
                backtab = 'Symptoms';
                break;
            case 'Upload_Document':
                backtab = 'Pre-Existing';
                break;
            default:
                return;
        }

        $(`[href="#${backtab}"]`).tab('show');
    }

    function proceedToNextTab() {
        let currentTab = $('.tab-content .active').attr('id');
        let nextTab;

        switch (currentTab) {
            case 'Vitals':
                nextTab = 'Symptoms';
                break;
            case 'Symptoms':
                nextTab = 'Pre-Existing';
                break;
            case 'Pre-Existing':
                nextTab = 'Upload_Document';
                break;
            case 'Upload_Document':
                break;
            default:
                return; // Exit if the current tab doesn't have a defined next tab
        }



        $(`[href="#${nextTab}"]`).tab('show');
    }

    const cl2Height = document.getElementById("cl2").offsetHeight;
    const cl10Height = document.getElementById("cl10").offsetHeight;
    const maxH = Math.max(cl2Height, cl10Height);
    document.getElementById("cl2").style.height = maxH + "px";
    document.getElementById("cl10").style.height = maxH + "px";

    $(document).ready(function () {
        // Attach the click event handler to the "+" button in the table with ID "Docupload"
        $("#Docupload").on("click", ".add-row", function () {
            var rowCounts = $("#Docupload tbody tr").length;
            var newRow = '<tr>' +
                '<td>' + (rowCounts + 1) + '</td>' +
                '<td><input type="text" name="Upload_Document_name" class="form-control form-control-sm"></td>' +
                '<td><select name="Upload_Doc_Type" class="form-control form-control-sm">' +
                '<option value="Prescription" >Prescription</option>' +
                '<option value="Lab report" >Lab report</option>' +
                '<option value="Insurance" >Insurance</option>' +
                '<option value="X-ray" >X-ray</option>' +
                '</select></td>' +
                '<td><input type="text" name="Upload_Description" class="form-control form-control-sm"></td>' +
                '<td><input type="text" name="Upload_Remark" class="form-control form-control-sm"></td>' +
                '<td><input type="file" name="Upload_File" class="form-control form-control-sm"></td>' +
                '<td><button type="button" class="btn  btn-sm add-row backgroundneela"><i class="fa-solid fa-plus fa-lg" ></i ></button ></td > '
                +
                '<td><button type="button" class="btn btn-danger btn-sm remove-rows"><i class="fa-regular fa-trash-can fa-lg" ></i ></button ></td > ' +
                '</tr>';
            $("#Docupload tbody").append(newRow);

            // Enable minus button in the previous row
            $(".remove-rows").prop("disabled", false);

            // Disable minus button in the first row when there's only one row
            if (rowCounts === 0) {
                $(".remove-rows:first").prop("disabled", true);
            }
        });

        // Remove Row
        $("#Docupload").on("click", ".remove-rows", function () {
            var rowCounts = $("#Docupload tbody tr").length;
            if (rowCounts > 1) {
                $(this).closest("tr").remove();
                updateRowNumbers();

                // Disable minus button in the first row when there's only one row left
                if (rowCounts === 2) {
                    $(".remove-rows:first").prop("disabled", true);
                }
            }
        });

        // Update row numbers
        function updateRowNumbers() {
            $("#Docupload tbody tr").each(function (index) {
                $(this).find("td:first").text(index + 1);
            });
        }
    });

    $(document).ready(function() {
  
    $("#submitSymptomsBtn").click(function() {
        var formData = $("#symptomsForm").serialize();
        
        $.ajax({
            type: "POST",
            url: "{% url 'symptoms_insert' %}",
            data: formData,
            dataType: 'json',  // Expect JSON response
            success: function(response) {
                if (response.success) {
                    // Handle success, e.g., redirect to the next page
                    proceedToNextTab();
                } else {
                    // Handle failure, show an error message
                    $('#failModal').modal('show');
                    console.error(response.message);
                }
            },
            error: function(error) {
                // Handle AJAX error
                console.error("AJAX Error:", error);
            }
        });
    });


    $("#submitVitals_Form").click(function() {
        var formData = $("#Vitals_Form").serialize();
        
        $.ajax({
            type: "POST",
            url: "{% url 'vitals_insert' %}",
            data: formData,
            dataType: 'json',  // Expect JSON response
            success: function(response) {
                if (response.success) {
                    // Handle success, e.g., redirect to the next page
                    proceedToNextTab();
                } else {
                    // Handle failure, show an error message
                    $('#failModal').modal('show');
                    console.error(response.message);
                }
            },
            error: function(error) {
                // Handle AJAX error
                $('#failModal').modal('show');
                console.error("AJAX Error:", error);
            }

        });
    });


    $("#submitPreExisting_Form").click(function() {
        var formData = $("#Pre-Existing_Form").serialize();
       
        $.ajax({
            type: "POST",
            url: "{% url 'preexisting_modal_insert' %}",
            data: formData,
            dataType: 'json',  // Expect JSON response
            success: function(response) {
                if (response.success) {
                    proceedToNextTab();
                } else {
                    // Handle failure, show an error message
                    $('#failModal').modal('show');
                    console.error(response.message);
                }
            },
            error: function(error) {
                // Handle AJAX error
                console.error("AJAX Error:", error);
            }

        });
    });


    $("#submitUpload_Document_Form").click(function () {
        var formData = new FormData($("#Upload_Document_Form")[0]);
       
        $.ajax({
            type: "POST",
            url: "{% url 'upload_documents' %}",
            data: formData,
            contentType: false,
            processData: false,
            dataType: 'json',  // Expect JSON response

            success: function (response) {
                if (response.success) {
                    $('#successModal').modal('show');
                } else {
                    // Handle failure, show an error message
                    $('#failModal').modal('show');
                    console.error(response.message);
                }
            },
            error: function (error) {
                // Handle AJAX error
                console.error("AJAX Error:", error);
            }

        });
    });

});



</script>


{% endblock %}